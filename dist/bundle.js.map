{"version":3,"sources":["../src/lfc.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["import _ from 'lodash'\n\nconst lfc = (form, options) => {\n\n  const { elements } = form\n\n  const allProperties = _.chain(elements)\n    .map('name')\n    .compact()\n    .uniq()\n    .value()\n\n  const _elements = _.pick(elements, allProperties)\n\n  const data = {}\n\n  _.each(_elements, (node, propName) => {\n    if (_.isArrayLikeObject(node)) {\n      _.each(node, (element, idx) => setData(element, idx + 1))\n    } else {\n      setData(node)\n    }\n  })\n\n  function setData(element, elementIdx) {\n\n    // console.dir(element)\n\n    const {\n      name,\n      type,\n      value,\n      checked,\n      disabled,\n      multiple,\n      step,\n      dataset,\n      tagName,\n      parentNode,\n    } = element\n\n    const {\n      number,\n    } = dataset\n\n    const parentNodeAllowMultiple = parentNode.multiple\n\n    if (disabled) return\n\n    const fieldName = elementIdx ? `${name}[${elementIdx - 1}]` : name\n\n    if (_.includes([\n      'text',\n      'password',\n      'textarea',\n      'email',\n      'url',\n      'tel',\n      'hidden',\n      'color',\n      'month',\n      'week',\n      'time',\n    ], type)) {\n      value && _.set(data, fieldName, _.trim(value))\n    }\n\n    if (_.includes(['number', 'range'], type)) {\n      const { step } = element\n      const decimal = step ? step.split('.')[1].length : 0\n      value && _.set(data, fieldName, step\n        ? _.round(value, decimal)\n        : parseInt(value)\n      )\n    }\n\n    if (_.includes(['radio'], type) && checked) {\n      value && _.set(data, name, value)\n    }\n\n    if (_.includes(['checkbox'], type) && !elementIdx) {\n      _.get(dataset, 'boolean')\n        ? _.set(data, name, checked ? true : false)\n        : (checked && _.set(data, name, value))\n    }\n\n    if (_.includes(['checkbox'], type) && elementIdx) {\n      const existValues = _.get(data, name)\n      if (_.get(dataset, 'boolean')) {\n        _.set(data, name, checked\n          ? (existValues ? _.concat(existValues, true) : [true])\n          : (existValues ? _.concat(existValues, false) : [false])\n        )\n      } else {\n        checked && _.set(data, name, existValues\n          ? _.concat(existValues, value)\n          : [value]\n        )\n      }\n    }\n\n    if (_.includes(['date', 'datetime-local'], type)) {\n      const { string } = dataset\n      value && _.set(data, fieldName, string\n        ? new Date(value).toISOString()\n        : new Date(value)\n      )\n    }\n\n    if ((tagName === 'OPTION' && parentNode.tagName === 'SELECT') && !parentNodeAllowMultiple) {\n      const to = parentNode.dataset.type\n      const _name = parentNode.name\n      const _value = parentNode.value\n      _value && _.set(data, _name, to ? convert({ to, value }) : _.trim(value))\n    }\n\n    if ((tagName === 'OPTION' && parentNode.tagName === 'SELECT') && parentNodeAllowMultiple) {\n      const _value = []\n\n      _.each(parentNode.selectedOptions, option => {\n        _value.push(convert({ to: parentNode.dataset.type, value: option.value }))\n      })\n\n      _.set(data, parentNode.name, _value)\n    }\n\n  }\n\n  return data\n\n}\n\nfunction convert({ to, value, decimal, separator = ',' }) {\n\n  const type = {\n    number() { return _.round(value, decimal) },\n    string() { return _.trim(value) },\n    array() { return value.join(separator) }\n  }\n\n  return type[to](value)\n}\n\nexport default lfc\n"]}