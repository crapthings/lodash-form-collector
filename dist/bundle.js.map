{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["import _ from 'lodash'\n\nconst lfc = (form, options) => {\n\n  const { elements, tagName: FORM } = form\n\n  if (FORM !== 'FORM')\n    throw new Error('first argument should be a form element')\n\n  const properties = _.chain(elements)\n    .map('name')\n    .compact()\n    .uniq()\n    .value()\n\n  const nodes = _.pick(elements, properties)\n\n  const data = _.stubObject()\n\n  _.each(nodes, node => {\n    _.isArrayLikeObject(node)\n      ? _.each(node, trimValue)\n      : trimValue(node)\n  })\n\n  _.each(nodes, (node, nodeName) => {\n    if (_.isArrayLikeObject(node)) {\n      const _node = _.chain(node)\n        .reject('disabled')\n        .reject(({ value }) => _.isEmpty(value))\n        .value()\n\n      _.each(_node, (element, elementIdx) => setData(element, elementIdx + 1))\n    } else {\n      node.value && setData(node)\n    }\n  })\n\n  function setData(element, elementIdx) {\n\n    const {\n      type: elementType,\n      name,\n      value,\n      checked,\n      multiple,\n      step,\n      dataset,\n      parentNode,\n      tagName,\n    } = element\n\n    const {\n      type: dataType,\n      separator,\n      unique,\n    } = dataset\n\n    const {\n      name: parentName,\n      value: parentValue,\n      multiple: allowMultiple,\n      tagName: parentTagName,\n      dataset: parentDataset,\n      selectedOptions,\n    } = parentNode\n\n    const propName = elementIdx ? `${name || parentName}[${elementIdx - 1}]` : name\n\n    const elementTypeIsSelect = (tagName === 'OPTION' && parentTagName === 'SELECT')\n\n    if (\n      elementIdx\n      && !_.get(data, name || parentName)\n      && elementType !== 'radio'\n      && parentTagName !== 'SELECT'\n    ) {\n      _.set(data, name || parentName, [])\n    }\n\n    if (_.includes([\n      'text',\n      'textarea',\n    ], elementType)) {\n      const _separator = {\n        text: separator || ',',\n        textarea: separator || '\\n',\n      }\n\n      let _value = dataType\n        ? convert({ to: dataType, value, separator: _.get(_separator, elementType) })\n        : value\n\n      if (unique) {\n        _value = _.uniq(_value)\n      }\n\n      _.set(data, propName, _value)\n    }\n\n    if (_.includes([\n      'password',\n      'email',\n      'hidden',\n      'url',\n      'tel',\n      'color',\n      'month',\n      'week',\n      'time',\n    ], elementType)) {\n      _.set(data, propName, value)\n    }\n\n    if (_.includes(['number', 'range'], elementType)) {\n      _.set(data, propName, step\n        ? _.round(value, _.chain(step).split('.').last().size())\n        : _.toNumber(value)\n      )\n    }\n\n    if (_.includes(['radio'], elementType) && checked) {\n      _.set(data, name, value)\n    }\n\n    if (_.includes(['checkbox'], elementType) && !elementIdx) {\n      _.eq(dataType, 'boolean')\n        ? _.set(data, name, checked ? true : false)\n        : (checked && _.set(data, name, value))\n    }\n\n    if (_.includes(['checkbox'], elementType) && elementIdx) {\n      const existValues = _.get(data, name, [])\n      if (_.eq(dataType, 'boolean')) {\n        _.set(data, name, _.concat(existValues, checked ? true : false))\n      } else {\n        checked && _.set(data, name, _.concat(existValues, value))\n      }\n    }\n\n    if (_.includes(['date', 'datetime-local'], elementType)) {\n      _.set(data, propName, _.eq(dataType, 'string')\n        ? new Date(value).toISOString()\n        : new Date(value)\n      )\n    }\n\n    if (elementTypeIsSelect && parentValue && !allowMultiple) {\n      const _type = dataType || parentDataset.type\n      _.set(data, parentName, _type\n        ? convert({ to: _type, value: parentValue })\n        : parentValue\n      )\n    }\n\n    if (elementTypeIsSelect && allowMultiple) {\n      let _value = []\n\n      _.each(selectedOptions, option => {\n        _value.push(convert({ to: parentDataset.type, value: option.value }))\n      })\n\n      if (parentDataset.flatten) {\n        _value = _.flatten(_value)\n      }\n\n      if (parentDataset.unique) {\n        _value = _.chain(_value).flatten().uniq().value()\n      }\n\n      _.set(data, parentNode.name, _value)\n    }\n\n  }\n\n  return data\n\n}\n\nfunction trimValue(element) {\n  element.value = _.trim(element.value)\n}\n\nfunction convert({ to, value, decimal, separator = ',' }) {\n\n  const dataType = {\n    string() { return value },\n\n    number() { return _.round(value, decimal) },\n\n    array() {\n      return _.chain(value)\n        .split(separator)\n        .compact()\n        .map(_.trim)\n        .value()\n    },\n\n    \"[number]\"() {\n      return _.chain(value)\n        .split(separator)\n        .map(item => _.round(item, decimal))\n        .value()\n    }\n  }\n\n  return dataType[to](value)\n}\n\nexport default lfc\n"]}