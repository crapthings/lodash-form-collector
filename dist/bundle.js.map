{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["import _ from 'lodash'\n\nconst lfc = (form, options) => {\n\n  const { elements, tagName: FORM } = form\n\n  if (FORM !== 'FORM')\n    throw new Error('first argument should be a form element')\n\n  const properties = _.chain(elements)\n    .map('name')\n    .compact()\n    .uniq()\n    .value()\n\n  const nodes = _.pick(elements, properties)\n\n  const data = _.stubObject()\n\n  _.each(nodes, node => {\n    _.isArrayLikeObject(node)\n      ? _.each(node, trimValue)\n      : trimValue(node)\n  })\n\n  _.each(nodes, (node, nodeName) => {\n    if (_.isArrayLikeObject(node)) {\n      _.each(node, setValue)\n    } else {\n      setValue(node)\n    }\n  })\n\n  function setValue(element, elementIdx) {\n\n    const hasMany = elementIdx >= 0\n\n    const {\n      type: elementType,\n      name,\n      value,\n      checked,\n      multiple,\n      disabled,\n      step,\n      dataset,\n      parentNode,\n      tagName,\n    } = element\n\n    const {\n      type: dataType,\n      separator,\n      unique,\n      skip,\n    } = dataset\n\n    const {\n      name: parentName,\n      value: parentValue,\n      multiple: allowMultiple,\n      tagName: parentTagName,\n      dataset: parentDataset,\n      selectedOptions,\n    } = parentNode\n\n    const elementTypeIsSelect = (tagName === 'OPTION' && parentTagName === 'SELECT')\n\n    if (\n      hasMany\n      && !_.get(data, name || parentName)\n      && elementType !== 'radio'\n      && parentTagName !== 'SELECT'\n    ) {\n      _.set(data, name || parentName, [])\n    }\n\n    if ((hasMany && value === \"\") || disabled || skip) {\n      return\n    }\n\n    if (_.includes([\n      'hidden',\n      'text',\n      'search',\n      'textarea',\n    ], elementType)) {\n      let _value = dataType\n        ? convert({ to: dataType, value, elementType })\n        : value\n\n      if (unique) {\n        _value = _.uniq(_value)\n      }\n\n      hasMany\n        ? _.set(data, name, _.concat(_.get(data, name, []), _value))\n        : _value && _.set(data, name, _value)\n    }\n\n    if (_.includes([\n      'tel',\n      'url',\n      'email',\n      'password',\n      'time',\n      'color',\n\n      'month',\n      'week',\n    ], elementType)) {\n      hasMany\n        ? _.set(data, name, _.concat(_.get(data, name, []), value))\n        : value && _.set(data, name, value)\n    }\n\n    if (_.includes(['number', 'range'], elementType)) {\n      _.set(data, name, step\n        ? _.round(value, _.chain(step).split('.').last().size())\n        : _.toNumber(value)\n      )\n    }\n\n    if (_.includes(['radio'], elementType) && checked) {\n      _.eq(dataType, 'boolean')\n        ? _.set(data, name, value === 'true' ? true : false)\n        : _.set(data, name, dataType\n            ? convert({ to: dataType, value})\n            : value\n          )\n    }\n\n    if (_.includes(['checkbox'], elementType)) {\n      const to = dataType || 'boolean'\n      _.set(data, name, hasMany\n        ? _.concat(_.get(data, name, []), convert({ to, value, checked }))\n        : convert({ to, value, checked })\n      )\n    }\n\n    if (_.includes(['date', 'datetime-local'], elementType)) {\n      _.set(data, name, _.eq(dataType, 'string')\n        ? new Date(value).toISOString()\n        : new Date(value)\n      )\n    }\n\n    if (\n      elementTypeIsSelect\n      && parentValue\n      && !allowMultiple\n    ) {\n      const _type = dataType || parentDataset.type\n      _.set(data, parentName, _type\n        ? convert({ to: _type, value: parentValue, elementType: 'text' })\n        : parentValue\n      )\n    }\n\n    if (\n      elementTypeIsSelect\n      && allowMultiple\n    ) {\n      let _values = []\n\n      _.each(selectedOptions, option => {\n        _values.push(convert({ to: parentDataset.type, value: option.value, elementType: 'text' }))\n      })\n\n      if (parentDataset.flatten) {\n        _values = _.flatten(_values)\n      }\n\n      if (parentDataset.unique) {\n        _values = _.chain(_values).flatten().uniq().value()\n      }\n\n      _.set(data, parentNode.name, _values)\n    }\n\n  }\n\n  return data\n\n}\n\nfunction trimValue(element) {\n  element.value = _.trim(element.value)\n}\n\nfunction convert({\n  to,\n  value,\n  checked,\n  decimal,\n  separator,\n  elementType,\n}) {\n\n  const _separator = {\n    text: ',',\n    textarea: '\\n',\n  }\n\n  const dataType = {\n    boolean() {\n      if (value === 'on') {\n        return checked ? true : false\n      } else {\n        if (checked) return value\n      }\n    },\n\n    string() { return value },\n\n    number() { return _.round(value, decimal) },\n\n    array() {\n      return _.chain(value)\n        .split(separator || _separator[elementType])\n        .compact()\n        .map(_.trim)\n        .value()\n    },\n\n    '[number]'() {\n      return _.chain(value)\n        .split(separator || _separator[elementType])\n        .map(item => _.round(item, decimal))\n        .value()\n    }\n  }\n\n  return dataType[to](value)\n\n}\n\nexport default lfc\n"]}