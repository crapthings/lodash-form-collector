{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["import _ from 'lodash'\n\nconst lfc = (form, options) => {\n\n  const { elements, tagName: FORM } = form\n\n  if (FORM !== 'FORM')\n    throw new Error('first argument should be a form element')\n\n  const properties = _.chain(elements)\n    .map('name')\n    .compact()\n    .uniq()\n    .value()\n\n  const nodes = _.pick(elements, properties)\n\n  const data = _.stubObject()\n\n  _.each(nodes, node => {\n    _.isArrayLikeObject(node)\n      ? _.each(node, trimValue)\n      : trimValue(node)\n  })\n\n  _.each(nodes, (node, nodeName) => {\n    if (_.isArrayLikeObject(node)) {\n      _.each(node, setValue)\n    } else {\n      setValue(node)\n    }\n  })\n\n  function setValue(element, elementIdx) {\n\n    const hasMany = elementIdx >= 0\n\n    const {\n      type: elementType,\n      name,\n      value,\n      checked,\n      multiple,\n      disabled,\n      step,\n      dataset,\n      parentNode,\n      tagName,\n    } = element\n\n    const {\n      type: dataType,\n      separator,\n      unique,\n      skip,\n    } = dataset\n\n    const {\n      name: parentName,\n      value: parentValue,\n      multiple: allowMultiple,\n      tagName: parentTagName,\n      dataset: parentDataset,\n      selectedOptions,\n    } = parentNode\n\n    const elementTypeIsSelect = (tagName === 'OPTION' && parentTagName === 'SELECT')\n\n    if (\n      hasMany\n      && !_.get(data, name || parentName)\n      && elementType !== 'radio'\n      && parentTagName !== 'SELECT'\n    ) {\n      _.set(data, name || parentName, [])\n    }\n\n    if ((hasMany && value === \"\") || disabled || skip) {\n      return\n    }\n\n    if (_.includes([\n      'hidden',\n      'text',\n      'search',\n      'textarea',\n    ], elementType)) {\n      let _value = dataType\n        ? convert({ to: dataType, value, elementType })\n        : value\n\n      if (unique) {\n        _value = _.uniq(_value)\n      }\n\n      hasMany\n        ? _.set(data, name, _.concat(_.get(data, name, []), _value))\n        : _value && _.set(data, name, _value)\n    }\n\n    if (_.includes([\n      'tel',\n      'url',\n      'email',\n      'password',\n      'time',\n      'color',\n\n      'month',\n      'week',\n    ], elementType)) {\n      hasMany\n        ? _.set(data, name, _.concat(_.get(data, name, []), value))\n        : value && _.set(data, name, value)\n    }\n\n    if (_.includes(['number', 'range'], elementType)) {\n      _.set(data, name, step\n        ? _.round(value, _.chain(step).split('.').last().size())\n        : _.toNumber(value)\n      )\n    }\n\n    if (_.includes(['radio'], elementType) && checked) {\n      _.eq(dataType, 'boolean')\n        ? _.set(data, name, value === 'true' ? true : false)\n        : _.set(data, name, dataType\n            ? convert({ to: dataType, value})\n            : value\n          )\n    }\n\n    if (_.includes(['checkbox'], elementType) && !hasMany) {\n      _.eq(dataType, 'boolean')\n        ? _.set(data, name, checked ? true : false)\n        : (checked && _.set(data, name, dataType\n            ? convert({ to: dataType, value})\n            : value)\n          )\n    }\n\n    if (_.includes(['checkbox'], elementType) && hasMany) {\n      const existValues = _.get(data, name, [])\n      _.eq(dataType, 'boolean')\n        ? _.set(data, name, _.concat(existValues, checked ? true : false))\n        : checked && _.set(data, name, _.concat(existValues, dataType\n            ? convert({ to: dataType, value})\n            : value\n          ))\n    }\n\n    if (_.includes(['date', 'datetime-local'], elementType)) {\n      _.set(data, name, _.eq(dataType, 'string')\n        ? new Date(value).toISOString()\n        : new Date(value)\n      )\n    }\n\n    if (\n      elementTypeIsSelect\n      && parentValue\n      && !allowMultiple\n    ) {\n      const _type = dataType || parentDataset.type\n      _.set(data, parentName, _type\n        ? convert({ to: _type, value: parentValue, elementType: 'text' })\n        : parentValue\n      )\n    }\n\n    if (\n      elementTypeIsSelect\n      && allowMultiple\n    ) {\n      let _values = []\n\n      _.each(selectedOptions, option => {\n        _values.push(convert({ to: parentDataset.type, value: option.value, elementType: 'text' }))\n      })\n\n      if (parentDataset.flatten) {\n        _values = _.flatten(_values)\n      }\n\n      if (parentDataset.unique) {\n        _values = _.chain(_values).flatten().uniq().value()\n      }\n\n      _.set(data, parentNode.name, _values)\n    }\n\n  }\n\n  return data\n\n}\n\nfunction trimValue(element) {\n  element.value = _.trim(element.value)\n}\n\nfunction convert({\n  to,\n  value,\n  decimal,\n  separator,\n  elementType,\n}) {\n\n  const _separator = {\n    text: ',',\n    textarea: '\\n',\n  }\n\n  const dataType = {\n    string() { return value },\n\n    number() { return _.round(value, decimal) },\n\n    array() {\n      return _.chain(value)\n        .split(separator || _separator[elementType])\n        .compact()\n        .map(_.trim)\n        .value()\n    },\n\n    \"[number]\"() {\n      return _.chain(value)\n        .split(separator || _separator[elementType])\n        .map(item => _.round(item, decimal))\n        .value()\n    }\n  }\n\n  return dataType[to](value)\n\n}\n\nexport default lfc\n"]}